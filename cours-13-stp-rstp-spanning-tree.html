<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cours 13 ‚Äî STP / RSTP : Spanning Tree ¬∑ Network+</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=Epilogue:wght@400;600;800;900&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #07090f; --bg2: #0d1117; --card: #111826;
    --border: #1c2a3a; --text: #dde4f0; --muted: #536070;
    --accent: #38bdf8; --green: #22d3a0; --amber: #fbbf24;
    --red: #f87171; --purple: #a78bfa;
  }
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  body { background: var(--bg); color: var(--text); font-family: 'Epilogue', sans-serif; min-height: 100vh; line-height: 1.75; }
  body::before { content: ''; position: fixed; inset: 0; background-image: radial-gradient(rgba(56,189,248,0.06) 1px, transparent 1px); background-size: 28px 28px; pointer-events: none; z-index: 0; }
  .wrap { max-width: 860px; margin: 0 auto; padding: 48px 20px 100px; position: relative; z-index: 1; }

  .breadcrumb { font-family: 'IBM Plex Mono', monospace; font-size: 0.68rem; color: var(--muted); letter-spacing: 1px; margin-bottom: 24px; display: flex; align-items: center; gap: 8px; }
  .breadcrumb span { color: var(--accent); }
  .pills { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 20px; }
  .pill { font-family: 'IBM Plex Mono', monospace; font-size: 0.65rem; letter-spacing: 1px; text-transform: uppercase; padding: 4px 12px; border-radius: 6px; font-weight: 600; }
  .pill-phase { color: var(--accent); background: rgba(56,189,248,0.08); border: 1px solid rgba(56,189,248,0.2); }
  .pill-key   { color: var(--purple); background: rgba(167,139,250,0.08); border: 1px solid rgba(167,139,250,0.2); }
  .pill-exam  { color: var(--red);    background: rgba(248,113,113,0.08);  border: 1px solid rgba(248,113,113,0.2); }
  .pill-diff  { color: var(--amber);  background: rgba(251,191,36,0.08);  border: 1px solid rgba(251,191,36,0.2); }

  h1 { font-size: clamp(1.8rem, 4vw, 2.8rem); font-weight: 900; line-height: 1.05; letter-spacing: -1px; margin-bottom: 8px; }
  h1 span { color: var(--accent); }
  .tagline { font-family: 'IBM Plex Mono', monospace; font-size: 0.78rem; color: var(--muted); margin-bottom: 36px; display: block; }

  .mastery-card { background: var(--card); border: 1px solid var(--border); border-radius: 14px; padding: 20px 24px; margin-bottom: 36px; }
  .mastery-title { font-family: 'IBM Plex Mono', monospace; font-size: 0.68rem; color: var(--muted); text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 14px; }
  .mastery-checks { display: flex; flex-direction: column; gap: 8px; }
  .mcheck { display: flex; align-items: center; gap: 12px; cursor: pointer; user-select: none; padding: 8px 12px; border-radius: 8px; transition: background 0.15s; }
  .mcheck:hover { background: rgba(56,189,248,0.04); }
  .mcheck-box { width: 18px; height: 18px; border: 1.5px solid var(--border); border-radius: 5px; flex-shrink: 0; display: flex; align-items: center; justify-content: center; font-size: 10px; color: transparent; transition: all 0.18s; }
  .mcheck-box.done { background: var(--green); border-color: var(--green); color: #fff; }
  .mcheck-label { font-size: 0.88rem; transition: color 0.2s; }
  .mcheck.done .mcheck-label { color: var(--muted); text-decoration: line-through; }
  .mastery-bar-wrap { height: 4px; background: var(--border); border-radius: 99px; margin-top: 16px; overflow: hidden; }
  .mastery-bar-fill { height: 100%; width: 0%; background: linear-gradient(90deg, var(--green), var(--accent)); border-radius: 99px; transition: width 0.4s ease; }

  .section { background: var(--card); border: 1px solid var(--border); border-radius: 14px; padding: 28px 30px; margin-bottom: 16px; }
  .section-label { font-family: 'IBM Plex Mono', monospace; font-size: 0.65rem; color: var(--muted); text-transform: uppercase; letter-spacing: 2px; margin-bottom: 16px; display: flex; align-items: center; gap: 10px; }
  .section-label::after { content: ''; flex: 1; height: 1px; background: var(--border); }
  h2 { font-size: 1.15rem; font-weight: 800; margin-bottom: 14px; }
  h3 { font-size: 0.95rem; font-weight: 700; color: var(--accent); margin: 22px 0 10px; font-family: 'IBM Plex Mono', monospace; }
  p { margin-bottom: 14px; font-size: 0.92rem; }

  .callout { border-radius: 10px; padding: 14px 18px; margin: 14px 0; font-size: 0.88rem; display: flex; gap: 12px; align-items: flex-start; }
  .callout-icon { flex-shrink: 0; font-size: 1rem; margin-top: 1px; }
  .callout-body { flex: 1; line-height: 1.65; }
  .callout-body strong { display: block; margin-bottom: 4px; font-size: 0.85rem; }
  .callout.analogy { background: rgba(167,139,250,0.07); border: 1px solid rgba(167,139,250,0.2); }
  .callout.analogy .callout-body strong { color: var(--purple); }
  .callout.tip  { background: rgba(56,189,248,0.06);  border: 1px solid rgba(56,189,248,0.18); }
  .callout.tip .callout-body strong { color: var(--accent); }
  .callout.warn { background: rgba(248,113,113,0.07); border: 1px solid rgba(248,113,113,0.2); }
  .callout.warn .callout-body strong { color: var(--red); }
  .callout.exam { background: rgba(251,191,36,0.07);  border: 1px solid rgba(251,191,36,0.2); }
  .callout.exam .callout-body strong { color: var(--amber); }
  .callout.ok   { background: rgba(34,211,160,0.07);  border: 1px solid rgba(34,211,160,0.2); }
  .callout.ok .callout-body strong { color: var(--green); }

  .vocab { background: var(--bg2); border-left: 3px solid var(--accent); border-radius: 0 8px 8px 0; padding: 12px 16px; margin: 12px 0; font-size: 0.88rem; }
  .vocab-term { font-family: 'IBM Plex Mono', monospace; color: var(--accent); font-weight: 600; margin-bottom: 4px; }

  .tbl-wrap { overflow-x: auto; margin: 16px 0; }
  table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
  th { background: var(--bg2); color: var(--muted); font-family: 'IBM Plex Mono', monospace; font-size: 0.65rem; text-transform: uppercase; letter-spacing: 1px; padding: 10px 14px; text-align: left; border-bottom: 1px solid var(--border); }
  td { padding: 10px 14px; border-bottom: 1px solid rgba(28,42,58,0.6); vertical-align: top; }
  tr:last-child td { border-bottom: none; }
  tr:hover td { background: rgba(56,189,248,0.02); }
  td strong { color: var(--accent); }
  code { font-family: 'IBM Plex Mono', monospace; font-size: 0.8rem; color: var(--accent); background: rgba(56,189,248,0.08); padding: 1px 5px; border-radius: 4px; }

  .trap-box { background: rgba(248,113,113,0.05); border: 2px solid var(--red); border-radius: 10px; padding: 18px 22px; margin: 20px 0; }
  .trap-title { font-family: 'IBM Plex Mono', monospace; font-weight: 800; font-size: 0.85rem; color: var(--red); margin-bottom: 12px; text-transform: uppercase; letter-spacing: 1px; }
  .trap-content { font-size: 0.88rem; line-height: 1.8; }

  .comptia-box { background: rgba(251,191,36,0.05); border: 2px solid var(--amber); border-radius: 10px; padding: 18px 22px; margin: 20px 0; }
  .comptia-title { font-family: 'IBM Plex Mono', monospace; font-weight: 800; font-size: 0.85rem; color: var(--amber); margin-bottom: 12px; text-transform: uppercase; letter-spacing: 1px; }
  .comptia-content { font-size: 0.88rem; line-height: 1.8; }

  .kp { display: flex; gap: 10px; align-items: flex-start; font-size: 0.88rem; padding: 9px 0; border-bottom: 1px solid rgba(28,42,58,0.5); }
  .kp:last-child { border-bottom: none; }
  .kp-dot { color: var(--accent); font-weight: 900; flex-shrink: 0; margin-top: 2px; }

  .exq { background: var(--bg2); border: 1px solid var(--border); border-radius: 8px; padding: 12px 16px; margin-bottom: 8px; font-size: 0.85rem; cursor: pointer; display: flex; align-items: flex-start; gap: 12px; transition: border-color 0.2s; }
  .exq:hover { border-color: rgba(56,189,248,0.25); }
  .exq-num { font-family: 'IBM Plex Mono', monospace; color: var(--muted); min-width: 24px; flex-shrink: 0; margin-top: 2px; }
  .exq-text { flex: 1; color: var(--text); }
  .exq-reveal { font-family: 'IBM Plex Mono', monospace; color: var(--muted); font-size: 0.7rem; white-space: nowrap; margin-top: 2px; }
  .exq-answer { display: none; background: rgba(34,211,160,0.06); border: 1px solid rgba(34,211,160,0.2); border-radius: 8px; padding: 12px 16px; font-size: 0.85rem; color: var(--green); margin-bottom: 10px; line-height: 1.8; }
  .exq-answer.visible { display: block; }

  .nav-footer { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px; margin-top: 48px; padding-top: 28px; border-top: 1px solid var(--border); }
  .nav-btn { font-family: 'IBM Plex Mono', monospace; font-size: 0.72rem; padding: 10px 18px; border-radius: 8px; transition: all 0.2s; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; border: 1px solid var(--border); background: var(--card); color: var(--muted); }
  .nav-btn.next { background: rgba(56,189,248,0.08); border-color: rgba(56,189,248,0.25); color: var(--accent); }
  .nav-btn.next:hover { background: rgba(56,189,248,0.15); }

  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: var(--bg); }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 99px; }
</style>
</head>
<body>
<div class="wrap">

  <div class="breadcrumb">Network+ N10-009 &nbsp;‚Ä∫&nbsp; <span>Phase 1 ‚Äî Fondamentaux</span> &nbsp;‚Ä∫&nbsp; Cours 13</div>

  <div class="pills">
    <span class="pill pill-phase">Phase 1 ¬∑ C13</span>
    <span class="pill pill-key">üîë KEY</span>
    <span class="pill pill-exam">‚ö†Ô∏è EXAM</span>
    <span class="pill pill-diff">‚ö°‚ö°‚ö° Difficile</span>
  </div>

  <h1>STP / RSTP ‚Äî <span>Spanning Tree</span></h1>
  <span class="tagline">// Pr√©vention des boucles r√©seau ‚Äî Root Bridge, √©tats des ports, BPDU</span>

  <div class="mastery-card">
    <div class="mastery-title">Suivi de ma√Ætrise</div>
    <div class="mastery-checks">
      <div class="mcheck" onclick="toggleCheck(this)"><div class="mcheck-box">‚úì</div><span class="mcheck-label">J'ai lu ce cours en entier</span></div>
      <div class="mcheck" onclick="toggleCheck(this)"><div class="mcheck-box">‚úì</div><span class="mcheck-label">Je comprends pourquoi les boucles sont dangereuses</span></div>
      <div class="mcheck" onclick="toggleCheck(this)"><div class="mcheck-box">‚úì</div><span class="mcheck-label">Je connais l'√©lection du Root Bridge</span></div>
      <div class="mcheck" onclick="toggleCheck(this)"><div class="mcheck-box">‚úì</div><span class="mcheck-label">Je ma√Ætrise les 4 √©tats de ports STP</span></div>
      <div class="mcheck" onclick="toggleCheck(this)"><div class="mcheck-box">‚úì</div><span class="mcheck-label">J'ai r√©ussi tous les exercices sans regarder le cours</span></div>
    </div>
    <div class="mastery-bar-wrap"><div class="mastery-bar-fill" id="mastBar"></div></div>
  </div>

  <!-- 1. LE PROBL√àME -->
  <div class="section">
    <div class="section-label">Avant de commencer</div>
    <h2>Le probl√®me ‚Äî les boucles r√©seau (loops)</h2>

    <div class="callout analogy">
      <span class="callout-icon">üîÅ</span>
      <div class="callout-body">
        <strong>Analogie ‚Äî la salle des miroirs</strong>
        Imagine deux miroirs face √† face. Une lumi√®re rebondit infiniment entre les deux. Pareil sur un r√©seau : une trame Ethernet broadcast envoy√©e dans une boucle circule INFINIMENT jusqu'√† saturer compl√®tement le r√©seau en quelques secondes.
      </div>
    </div>

    <p><strong>Sc√©nario probl√©matique :</strong> Tu connectes 3 switches en triangle (Switch A ‚Üî Switch B ‚Üî Switch C ‚Üî Switch A). Un PC envoie un broadcast ARP. Que se passe-t-il ?</p>

    <ol style="margin:10px 0 16px 24px;line-height:1.9">
      <li>Switch A re√ßoit le broadcast et le flood sur tous les ports (vers B et C)</li>
      <li>Switch B re√ßoit le broadcast et le flood (vers A et C)</li>
      <li>Switch C re√ßoit le broadcast et le flood (vers A et B)</li>
      <li>Le broadcast circule infiniment A ‚Üí B ‚Üí C ‚Üí A ‚Üí B ‚Üí C...</li>
      <li><strong>R√©sultat : Temp√™te de broadcast (Broadcast Storm)</strong> ‚Äî le r√©seau sature en secondes</li>
    </ol>

    <h3>// Les 3 probl√®mes des boucles r√©seau</h3>
    <div class="tbl-wrap">
      <table>
        <tr><th>Probl√®me</th><th>Description</th></tr>
        <tr><td><strong>Broadcast Storm</strong></td><td>Les broadcasts circulent infiniment, saturent la bande passante ‚Üí r√©seau inutilisable</td></tr>
        <tr><td><strong>Instabilit√© de la table MAC</strong></td><td>Le switch voit la m√™me MAC sur plusieurs ports diff√©rents ‚Üí confusion ‚Üí table MAC corrompue</td></tr>
        <tr><td><strong>Duplication de trames</strong></td><td>Une trame unicast peut arriver plusieurs fois au destinataire par chemins diff√©rents</td></tr>
      </table>
    </div>

    <div class="callout warn">
      <span class="callout-icon">üí•</span>
      <div class="callout-body">
        <strong>Impact r√©el</strong>
        Sans STP, une boucle r√©seau provoque un crash total en 5-30 secondes. Les LED des switches clignotent √† 100%, le r√©seau devient compl√®tement inutilisable. La seule solution : d√©brancher physiquement un c√¢ble pour casser la boucle.
      </div>
    </div>

    <div class="callout tip">
      <span class="callout-icon">üéØ</span>
      <div class="callout-body">
        <strong>La solution : STP (Spanning Tree Protocol)</strong>
        STP d√©tecte automatiquement les boucles et BLOQUE certains ports pour cr√©er une topologie sans boucle (arbre). Si un lien tombe, STP r√©active automatiquement un port bloqu√© pour restaurer la connectivit√©.
      </div>
    </div>
  </div>

  <!-- 2. VOCABULAIRE -->
  <div class="section">
    <div class="section-label">Vocabulaire essentiel</div>
    <h2>Les mots cl√©s de ce cours</h2>

    <div class="vocab">
      <div class="vocab-term">STP (Spanning Tree Protocol)</div>
      <div>Protocole IEEE 802.1D qui pr√©vient les boucles r√©seau en bloquant intelligemment certains ports. Temps de convergence : 30-50 secondes.</div>
    </div>
    <div class="vocab">
      <div class="vocab-term">RSTP (Rapid Spanning Tree Protocol)</div>
      <div>Version rapide de STP (IEEE 802.1w). Convergence en 1-3 secondes au lieu de 30-50s. R√©trocompatible avec STP.</div>
    </div>
    <div class="vocab">
      <div class="vocab-term">Root Bridge (Pont racine)</div>
      <div>Le switch "ma√Ætre" dans une topologie STP. C'est le point de r√©f√©rence central. Tous les autres switches calculent leurs chemins vers le Root Bridge.</div>
    </div>
    <div class="vocab">
      <div class="vocab-term">BPDU (Bridge Protocol Data Unit)</div>
      <div>Messages √©chang√©s entre switches pour √©lire le Root Bridge, d√©tecter les boucles, et d√©terminer quels ports bloquer.</div>
    </div>
    <div class="vocab">
      <div class="vocab-term">Bridge ID</div>
      <div">Identifiant unique d'un switch = Priorit√© (16 bits) + MAC address (48 bits). Utilis√© pour √©lire le Root Bridge.</div>
    </div>
    <div class="vocab">
      <div class="vocab-term">Root Port (RP)</div>
      <div>Sur chaque switch non-root, c'est le port avec le chemin le plus court vers le Root Bridge. √âtat : Forwarding.</div>
    </div>
    <div class="vocab">
      <div class="vocab-term">Designated Port (DP)</div>
      <div>Sur chaque segment, c'est le port qui envoie le trafic vers le Root Bridge. √âtat : Forwarding.</div>
    </div>
    <div class="vocab">
      <div class="vocab-term">Non-Designated Port (Blocked Port)</div>
      <div>Port bloqu√© pour casser la boucle. N'envoie ni ne re√ßoit de trafic utilisateur (√©coute uniquement les BPDU).</div>
    </div>
    <div class="vocab">
      <div class="vocab-term">PortFast</div>
      <div>Fonctionnalit√© qui permet √† un port Access (connect√© √† un PC) de passer imm√©diatement en Forwarding sans attendre les √©tats STP. Gain de temps au boot.</div>
    </div>
    <div class="vocab">
      <div class="vocab-term">BPDU Guard</div>
      <div>S√©curit√© : si un BPDU est re√ßu sur un port PortFast (suppos√© connecter un PC), le port est automatiquement d√©sactiv√©. Emp√™che les boucles accidentelles.</div>
    </div>
  </div>

  <!-- 3. ROOT BRIDGE ELECTION -->
  <div class="section">
    <div class="section-label">√âlection du chef</div>
    <h2>√âlection du Root Bridge ‚Äî le switch ma√Ætre</h2>

    <p>Tous les switches d'un r√©seau participent √† une <strong>√©lection d√©mocratique</strong> pour d√©signer un Root Bridge (le switch de r√©f√©rence central).</p>

    <h3>// Processus d'√©lection</h3>
    <p><strong>Crit√®re de s√©lection :</strong> Le switch avec le <strong>Bridge ID le plus BAS</strong> devient Root Bridge.</p>

    <p><strong>Bridge ID = Priorit√© (16 bits) + MAC Address (48 bits)</strong></p>

    <p><strong>Ordre de comparaison :</strong></p>
    <ol style="margin:10px 0 16px 24px;line-height:1.9">
      <li><strong>Priorit√© la plus basse</strong> gagne (par d√©faut = 32768 sur tous les switches)</li>
      <li>Si √©galit√© de priorit√© ‚Üí <strong>MAC la plus basse</strong> gagne (tiebreaker automatique)</li>
    </ol>

    <p><strong>Exemple :</strong></p>
    <div class="tbl-wrap">
      <table>
        <tr><th>Switch</th><th>Priorit√©</th><th>MAC Address</th><th>Bridge ID</th><th>R√©sultat</th></tr>
        <tr><td>Switch A</td><td>32768</td><td>00:1A:2B:3C:4D:01</td><td>32768.001A2B3C4D01</td><td>‚Äî</td></tr>
        <tr><td>Switch B</td><td>32768</td><td>00:1A:2B:3C:4D:02</td><td>32768.001A2B3C4D02</td><td>‚Äî</td></tr>
        <tr><td>Switch C</td><td>32768</td><td>00:1A:2B:3C:4D:00</td><td>32768.001A2B3C4D00</td><td style="color:var(--green)">‚úÖ Root Bridge (MAC la plus basse)</td></tr>
      </table>
    </div>

    <h3>// Forcer un switch comme Root Bridge</h3>
    <p>En production, tu ne veux PAS que le Root Bridge soit choisi al√©atoirement selon la MAC. Tu veux que ce soit ton switch le plus performant et central.</p>

    <p><strong>Solution :</strong> Baisser manuellement la priorit√© du switch souhait√©.</p>

    <div style="background:var(--bg2);border:1px solid var(--border);border-radius:8px;padding:14px 18px;margin:14px 0;font-family:'IBM Plex Mono',monospace;font-size:0.8rem;line-height:1.8;">
      <span style="color:var(--green)">Switch(config)#</span> spanning-tree vlan 1 priority 4096<br>
      <span style="color:var(--muted);font-style:italic">! Priorit√© = 4096 (doit √™tre multiple de 4096)</span><br>
      <span style="color:var(--muted);font-style:italic">! Valeurs possibles : 0, 4096, 8192, ..., 61440</span>
    </div>

    <p>Avec une priorit√© de 4096, ce switch deviendra Root Bridge (4096 < 32768 par d√©faut).</p>

    <div class="callout ok">
      <span class="callout-icon">üèÜ</span>
      <div class="callout-body">
        <strong>Bonne pratique</strong>
        Core Switch (datacenter) = priorit√© 4096 (Root Bridge principal)<br>
        Distribution Switch = priorit√© 8192 (Root Bridge de secours)<br>
        Access Switches = priorit√© par d√©faut 32768
      </div>
    </div>
  </div>

  <!-- 4. PORT STATES -->
  <div class="section">
    <div class="section-label">Cycle de vie des ports</div>
    <h2>Les 4 √©tats de ports STP</h2>

    <p>Un port STP passe par plusieurs √©tats avant d'√™tre utilisable. <strong>Dur√©e totale STP classique : 30-50 secondes</strong>.</p>

    <div class="tbl-wrap">
      <table>
        <tr><th>√âtat</th><th>Dur√©e</th><th>√âcoute BPDU</th><th>Envoie BPDU</th><th>Apprend MAC</th><th>Forwarding</th></tr>
        <tr>
          <td><strong>Blocking</strong></td>
          <td>‚àû</td>
          <td>‚úÖ Oui</td>
          <td>‚ùå Non</td>
          <td>‚ùå Non</td>
          <td>‚ùå Non</td>
        </tr>
        <tr>
          <td><strong>Listening</strong></td>
          <td>15s</td>
          <td>‚úÖ Oui</td>
          <td>‚úÖ Oui</td>
          <td>‚ùå Non</td>
          <td>‚ùå Non</td>
        </tr>
        <tr>
          <td><strong>Learning</strong></td>
          <td>15s</td>
          <td>‚úÖ Oui</td>
          <td>‚úÖ Oui</td>
          <td>‚úÖ Oui</td>
          <td>‚ùå Non</td>
        </tr>
        <tr>
          <td><strong>Forwarding</strong></td>
          <td>‚àû</td>
          <td>‚úÖ Oui</td>
          <td>‚úÖ Oui</td>
          <td>‚úÖ Oui</td>
          <td>‚úÖ Oui</td>
        </tr>
      </table>
    </div>

    <h3>// D√©tail de chaque √©tat</h3>

    <p><strong>1. Blocking (Bloqu√©)</strong></p>
    <ul style="margin:10px 0 16px 24px;line-height:1.9">
      <li>Port d√©sactiv√© pour casser la boucle</li>
      <li>√âcoute les BPDU (pour d√©tecter si la topologie change)</li>
      <li>N'envoie aucun trafic utilisateur</li>
      <li>Dur√©e : ind√©finie (jusqu'√† changement de topologie)</li>
    </ul>

    <p><strong>2. Listening (√âcoute)</strong></p>
    <ul style="margin:10px 0 16px 24px;line-height:1.9">
      <li>Le port se pr√©pare √† participer activement √† STP</li>
      <li>√âcoute et envoie des BPDU</li>
      <li>Ne transmet PAS encore de trafic utilisateur</li>
      <li>Dur√©e : 15 secondes (Forward Delay timer)</li>
    </ul>

    <p><strong>3. Learning (Apprentissage)</strong></p>
    <ul style="margin:10px 0 16px 24px;line-height:1.9">
      <li>Le port commence √† apprendre les adresses MAC</li>
      <li>Remplit sa table MAC</li>
      <li>Ne transmet PAS encore de trafic utilisateur</li>
      <li>Dur√©e : 15 secondes (Forward Delay timer)</li>
    </ul>

    <p><strong>4. Forwarding (Transmission)</strong></p>
    <ul style="margin:10px 0 16px 24px;line-height:1.9">
      <li>Port pleinement op√©rationnel</li>
      <li>Transmet le trafic utilisateur normalement</li>
      <li>Continue d'√©couter les BPDU</li>
      <li>Dur√©e : ind√©finie (√©tat normal)</li>
    </ul>

    <p><strong>Temps total de convergence STP :</strong> 15s (Listening) + 15s (Learning) = <strong>30 secondes minimum</strong></p>

    <div class="callout warn">
      <span class="callout-icon">‚è±Ô∏è</span>
      <div class="callout-body">
        <strong>Probl√®me de STP classique</strong>
        30-50 secondes de convergence, c'est TR√àS long. Si un lien tombe, le r√©seau est coup√© pendant 30s avant que STP ne r√©active un port bloqu√©. C'est pour √ßa que RSTP a √©t√© cr√©√© (convergence en 1-3s).
      </div>
    </div>
  </div>

  <!-- 5. RSTP -->
  <div class="section">
    <div class="section-label">Version rapide</div>
    <h2>RSTP (Rapid Spanning Tree) ‚Äî convergence en secondes</h2>

    <p><strong>RSTP (IEEE 802.1w)</strong> est une √©volution de STP qui converge en <strong>1-3 secondes</strong> au lieu de 30-50 secondes.</p>

    <h3>// Am√©liorations de RSTP</h3>
    <div class="tbl-wrap">
      <table>
        <tr><th>Fonctionnalit√©</th><th>STP (802.1D)</th><th>RSTP (802.1w)</th></tr>
        <tr><td>Convergence</td><td>30-50 secondes</td><td>1-3 secondes</td></tr>
        <tr><td>√âtats de ports</td><td>5 √©tats (Disabled, Blocking, Listening, Learning, Forwarding)</td><td>3 √©tats (Discarding, Learning, Forwarding)</td></tr>
        <tr><td>R√¥les de ports</td><td>Root, Designated, Non-Designated</td><td>Root, Designated, Alternate, Backup</td></tr>
        <tr><td>Compatibilit√©</td><td>‚Äî</td><td>R√©trocompatible avec STP</td></tr>
      </table>
    </div>

    <p><strong>Changements cl√©s :</strong></p>
    <ul style="margin:10px 0 16px 24px;line-height:1.9">
      <li><strong>Pas d'√©tat Listening</strong> : RSTP fusionne Blocking/Listening en un seul √©tat "Discarding"</li>
      <li><strong>Alternate Port</strong> : Port de backup pr√©-calcul√© qui peut activer instantan√©ment si le Root Port tombe</li>
      <li><strong>Proposal/Agreement</strong> : N√©gociation rapide entre switches pour activer un port sans attendre les timers</li>
    </ul>

    <div class="callout ok">
      <span class="callout-icon">‚úÖ</span>
      <div class="callout-body">
        <strong>Standard moderne</strong>
        RSTP est le standard actuel. Tous les switches modernes supportent RSTP. STP classique (802.1D) n'est plus utilis√© que pour compatibilit√© avec du tr√®s vieux mat√©riel.
      </div>
    </div>
  </div>

  <!-- 6. PORTFAST & BPDU GUARD -->
  <div class="section">
    <div class="section-label">Optimisations</div>
    <h2>PortFast et BPDU Guard ‚Äî pour les access ports</h2>

    <h3>// PortFast</h3>
    <p><strong>Probl√®me :</strong> Un PC branch√© sur un switch doit attendre 30s (STP) avant d'avoir acc√®s au r√©seau. C'est inutile car un PC ne cr√©e pas de boucle.</p>

    <p><strong>Solution :</strong> PortFast permet au port de passer imm√©diatement en <strong>Forwarding</strong> sans passer par Listening/Learning.</p>

    <div style="background:var(--bg2);border:1px solid var(--border);border-radius:8px;padding:14px 18px;margin:14px 0;font-family:'IBM Plex Mono',monospace;font-size:0.8rem;line-height:1.8;">
      <span style="color:var(--green)">Switch(config)#</span> interface FastEthernet0/1<br>
      <span style="color:var(--green)">Switch(config-if)#</span> spanning-tree portfast<br>
      <span style="color:var(--muted);font-style:italic">! Le port passe imm√©diatement en Forwarding</span>
    </div>

    <div class="callout warn">
      <span class="callout-icon">‚ö†Ô∏è</span>
      <div class="callout-body">
        <strong>DANGER ‚Äî PortFast uniquement sur Access Ports</strong>
        N'active JAMAIS PortFast sur un port qui connecte un switch ou un hub ‚Üí risque de boucle imm√©diate ! PortFast = uniquement pour PC, imprimantes, serveurs finaux.
      </div>
    </div>

    <h3>// BPDU Guard</h3>
    <p><strong>Probl√®me :</strong> Si quelqu'un branche accidentellement un switch sur un port PortFast ‚Üí boucle instantan√©e.</p>

    <p><strong>Solution :</strong> BPDU Guard d√©sactive automatiquement le port si un BPDU est re√ßu (= d√©tecte qu'un switch a √©t√© branch√©).</p>

    <div style="background:var(--bg2);border:1px solid var(--border);border-radius:8px;padding:14px 18px;margin:14px 0;font-family:'IBM Plex Mono',monospace;font-size:0.8rem;line-height:1.8;">
      <span style="color:var(--green)">Switch(config)#</span> interface FastEthernet0/1<br>
      <span style="color:var(--green)">Switch(config-if)#</span> spanning-tree portfast<br>
      <span style="color:var(--green)">Switch(config-if)#</span> spanning-tree bpduguard enable<br>
      <span style="color:var(--muted);font-style:italic">! Si BPDU re√ßu ‚Üí port shutdown imm√©diat (err-disabled)</span>
    </div>

    <div class="callout ok">
      <span class="callout-icon">üîí</span>
      <div class="callout-body">
        <strong>Bonne pratique de s√©curit√©</strong>
        Active TOUJOURS BPDU Guard sur TOUS les ports PortFast. C'est une protection essentielle contre les boucles accidentelles.
      </div>
    </div>
  </div>

  <!-- 7. CE QUI TROMPE LES CANDIDATS -->
  <div class="section">
    <div class="section-label">‚ö†Ô∏è Pi√®ges d'examen</div>
    <h2>Ce qui trompe les candidats</h2>

    <div class="trap-box">
      <div class="trap-title">‚ùå Pi√®ge #1 : Confondre Root Bridge et Root Port</div>
      <div class="trap-content">
        <strong>Root Bridge</strong> = le switch ma√Ætre (1 seul dans tout le r√©seau)<br>
        <strong>Root Port</strong> = sur chaque switch NON-root, c'est le port vers le Root Bridge<br><br>
        Erreur fr√©quente : penser que le Root Bridge a des Root Ports ‚Üí FAUX. Le Root Bridge n'a QUE des Designated Ports (tous en Forwarding).
      </div>
    </div>

    <div class="trap-box">
      <div class="trap-title">‚ùå Pi√®ge #2 : Croire que STP bloque tous les liens redondants</div>
      <div class="trap-content">
        STP bloque uniquement les ports qui cr√©ent des BOUCLES. Si tu as 2 liens parall√®les entre Switch A et Switch B, STP bloquera 1 des 2 liens (pas de boucle = pas de blocage ailleurs).
      </div>
    </div>

    <div class="trap-box">
      <div class="trap-title">‚ùå Pi√®ge #3 : Confondre PortFast et RSTP</div>
      <div class="trap-content">
        <strong>PortFast</strong> = d√©sactive STP sur un port Access (PC) ‚Üí instant forwarding<br>
        <strong>RSTP</strong> = version rapide de STP pour TOUT le r√©seau ‚Üí convergence en 1-3s<br><br>
        Ce n'est PAS la m√™me chose. PortFast ne remplace pas STP/RSTP.
      </div>
    </div>

    <div class="trap-box">
      <div class="trap-title">‚ùå Pi√®ge #4 : Temps de convergence</div>
      <div class="trap-content">
        Beaucoup de candidats pensent STP = 50s, RSTP = instantan√©. C'est faux.<br>
        <strong>STP</strong> : 30-50 secondes<br>
        <strong>RSTP</strong> : 1-3 secondes (pas instantan√©, mais tr√®s rapide)<br>
        <strong>PortFast</strong> : vraiment instantan√© (0s), mais UNIQUEMENT pour access ports
      </div>
    </div>
  </div>

  <!-- 8. CE QUE COMPTIA PEUT TE POSER -->
  <div class="section">
    <div class="section-label">üéØ Questions types</div>
    <h2>Ce que CompTIA peut te poser</h2>

    <div class="comptia-box">
      <div class="comptia-title">Question type #1 : √âlection Root Bridge</div>
      <div class="comptia-content">
        "Trois switches ont les Bridge ID suivants : Switch A (32768.001122334455), Switch B (4096.001122334466), Switch C (32768.001122334444). Lequel devient Root Bridge ?"<br><br>
        <strong>R√©ponse :</strong> Switch B (priorit√© 4096 est la plus basse)
      </div>
    </div>

    <div class="comptia-box">
      <div class="comptia-title">Question type #2 : Temps de convergence</div>
      <div class="comptia-content">
        "Un lien principal tombe sur un r√©seau STP classique. Combien de temps avant que le trafic soit r√©tabli via le lien de backup ?"<br><br>
        <strong>R√©ponse :</strong> 30-50 secondes (Listening 15s + Learning 15s)
      </div>
    </div>

    <div class="comptia-box">
      <div class="comptia-title">Question type #3 : PortFast danger</div>
      <div class="comptia-content">
        "Un technicien active PortFast sur un port trunk reliant deux switches. Quel est le risque ?"<br><br>
        <strong>R√©ponse :</strong> Boucle r√©seau imm√©diate ‚Üí broadcast storm ‚Üí crash r√©seau. PortFast ne doit JAMAIS √™tre activ√© sur un trunk.
      </div>
    </div>

    <div class="comptia-box">
      <div class="comptia-title">Question type #4 : BPDU Guard</div>
      <div class="comptia-content">
        "Un port avec BPDU Guard re√ßoit un BPDU. Que se passe-t-il ?"<br><br>
        <strong>R√©ponse :</strong> Le port passe en √©tat err-disabled (shutdown automatique). Il faut le r√©activer manuellement apr√®s avoir retir√© le switch ill√©gal.
      </div>
    </div>
  </div>

  <!-- 9. EXERCICES -->
  <div class="section">
    <div class="section-label">üß™ Exercices interactifs</div>
    <h2>Teste-toi ‚Äî sans regarder le cours</h2>
    <p style="font-family:'IBM Plex Mono',monospace;font-size:0.75rem;color:var(--muted);margin-bottom:16px;">Clique pour r√©v√©ler la r√©ponse.</p>

    <div class="exq" onclick="toggleAnswer(this)"><span class="exq-num">01</span><span class="exq-text">Pourquoi les boucles r√©seau sont-elles dangereuses ?</span><span class="exq-reveal">‚ñº voir</span></div>
    <div class="exq-answer">Les broadcasts circulent infiniment ‚Üí <strong>Broadcast Storm</strong> ‚Üí saturation bande passante ‚Üí r√©seau inutilisable en quelques secondes. Table MAC corrompue + duplication de trames.</div>

    <div class="exq" onclick="toggleAnswer(this)"><span class="exq-num">02</span><span class="exq-text">Comment le Root Bridge est-il √©lu ?</span><span class="exq-reveal">‚ñº voir</span></div>
    <div class="exq-answer">Switch avec le <strong>Bridge ID le plus bas</strong> ‚Üí Bridge ID = Priorit√© (d√©faut 32768) + MAC. Si priorit√©s √©gales, MAC la plus basse gagne.</div>

    <div class="exq" onclick="toggleAnswer(this)"><span class="exq-num">03</span><span class="exq-text">Quels sont les 4 √©tats de ports STP ?</span><span class="exq-reveal">‚ñº voir</span></div>
    <div class="exq-answer"><strong>Blocking</strong> (bloqu√©), <strong>Listening</strong> (15s), <strong>Learning</strong> (15s), <strong>Forwarding</strong> (actif). Total : 30s minimum.</div>

    <div class="exq" onclick="toggleAnswer(this)"><span class="exq-num">04</span><span class="exq-text">Quelle est la diff√©rence entre STP et RSTP ?</span><span class="exq-reveal">‚ñº voir</span></div>
    <div class="exq-answer"><strong>STP</strong> : convergence 30-50s, 5 √©tats<br><strong>RSTP</strong> : convergence 1-3s, 3 √©tats, r√©trocompatible. RSTP est le standard moderne.</div>

    <div class="exq" onclick="toggleAnswer(this)"><span class="exq-num">05</span><span class="exq-text">√Ä quoi sert PortFast ?</span><span class="exq-reveal">‚ñº voir</span></div>
    <div class="exq-answer">Permet √† un <strong>port Access (PC)</strong> de passer imm√©diatement en Forwarding sans attendre 30s. JAMAIS sur un trunk/port switch.</div>

    <div class="exq" onclick="toggleAnswer(this)"><span class="exq-num">06</span><span class="exq-text">√Ä quoi sert BPDU Guard ?</span><span class="exq-reveal">‚ñº voir</span></div>
    <div class="exq-answer">D√©sactive automatiquement un port PortFast si un BPDU est re√ßu (= switch branch√©). Protection contre boucles accidentelles.</div>

    <div class="exq" onclick="toggleAnswer(this)"><span class="exq-num">07</span><span class="exq-text">Question type examen : Le Root Bridge a-t-il des Root Ports ?</span><span class="exq-reveal">‚ñº voir</span></div>
    <div class="exq-answer"><strong>Non</strong>. Le Root Bridge n'a QUE des Designated Ports (tous en Forwarding). Les Root Ports sont sur les switches NON-root (vers le Root Bridge).</div>
  </div>

  <!-- 10. R√âSUM√â -->
  <div class="section">
    <div class="section-label">R√©sum√©</div>
    <h2>üîë Ce que tu dois retenir absolument</h2>
    <div>
      <div class="kp"><span class="kp-dot">‚Üí</span><span>Boucle r√©seau ‚Üí Broadcast Storm ‚Üí crash en 5-30 secondes</span></div>
      <div class="kp"><span class="kp-dot">‚Üí</span><span>STP (802.1D) pr√©vient les boucles en bloquant intelligemment certains ports</span></div>
      <div class="kp"><span class="kp-dot">‚Üí</span><span><strong>Root Bridge</strong> = switch avec Bridge ID le plus bas (Priorit√© + MAC)</span></div>
      <div class="kp"><span class="kp-dot">‚Üí</span><span>4 √©tats STP : Blocking ‚Üí Listening (15s) ‚Üí Learning (15s) ‚Üí Forwarding</span></div>
      <div class="kp"><span class="kp-dot">‚Üí</span><span>RSTP (802.1w) = version rapide : convergence 1-3s au lieu de 30-50s</span></div>
      <div class="kp"><span class="kp-dot">‚Üí</span><span><strong>PortFast</strong> = instant forwarding sur access ports (PC). JAMAIS sur trunk.</span></div>
      <div class="kp"><span class="kp-dot">‚Üí</span><span><strong>BPDU Guard</strong> = shutdown automatique si BPDU re√ßu sur port PortFast</span></div>
      <div class="kp"><span class="kp-dot">‚Üí</span><span>Root Bridge n'a QUE des Designated Ports. Root Ports = sur switches non-root.</span></div>
    </div>
  </div>

  <div class="nav-footer">
    <a class="nav-btn" href="#">‚Üê Cours 12 : VLAN ‚Äî Configuration</a>
    <span style="font-family:'IBM Plex Mono',monospace;font-size:0.7rem;color:var(--muted)">C13 ¬∑ Phase 1</span>
    <a class="nav-btn next" href="#">Cours 14 : Aggregation de liens (LACP) ‚Üí</a>
  </div>

</div>
<script>
const MKEY = 'netplus_c13_mastery';
let mastery = [];
try { mastery = JSON.parse(localStorage.getItem(MKEY) || '[]'); } catch(e) {}
function initMastery() {
  document.querySelectorAll('.mcheck').forEach((el, i) => {
    if(mastery[i]) { el.classList.add('done'); el.querySelector('.mcheck-box').classList.add('done'); }
  });
  updateBar();
}
function toggleCheck(el) {
  const i = Array.from(document.querySelectorAll('.mcheck')).indexOf(el);
  const isDone = el.classList.contains('done');
  const box = el.querySelector('.mcheck-box');
  isDone ? (el.classList.remove('done'), box.classList.remove('done'), mastery[i] = false)
         : (el.classList.add('done'), box.classList.add('done'), mastery[i] = true);
  localStorage.setItem(MKEY, JSON.stringify(mastery));
  updateBar();
}
function updateBar() {
  const total = document.querySelectorAll('.mcheck').length;
  const done  = document.querySelectorAll('.mcheck.done').length;
  document.getElementById('mastBar').style.width = Math.round(done/total*100) + '%';
}
function toggleAnswer(exqEl) {
  const answer = exqEl.nextElementSibling;
  const open = answer.classList.contains('visible');
  document.querySelectorAll('.exq-answer').forEach(a => a.classList.remove('visible'));
  document.querySelectorAll('.exq-reveal').forEach(r => r.textContent = '‚ñº voir');
  if(!open) { answer.classList.add('visible'); exqEl.querySelector('.exq-reveal').textContent = '‚ñ≤ cacher'; }
}
initMastery();
</script>
</body>
</html>
